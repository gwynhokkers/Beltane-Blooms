import{d as B,b9 as I,ba as N,bb as S,bc as j,D as a,bd as C,be as L,r as M,u as O,o as $,bf as D,c as u,e as l,F as H,ag as T,aj as U,E as b,g as V}from"./DTOpbP-P.js";const q=["type","sizes","srcset"],G=["src","sizes","srcset"],Q=B({__name:"NuxtPicture",props:I,emits:["load","error"],setup(y,{emit:_}){const s=y,v=N(),n=_,x=!1,o=S(),{attrs:z,options:A,modifiers:h}=j(s),d=a(()=>C(s.src)),F=a(()=>["png","webp","gif","svg"].includes(d.value)),i=a(()=>s.legacyFormat?s.legacyFormat:F.value?"png":"jpeg"),p=a(()=>{var g,t;const e=((g=s.format)==null?void 0:g.split(","))||(d.value==="svg"?["svg"]:(t=o.options.format)!=null&&t.length?[...o.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(i.value)&&e.splice(e.indexOf(i.value),1),e.push(i.value),e.map(f=>{const{srcset:E,sizes:w,src:P}=o.getSizes(s.src,{...A.value,sizes:s.sizes||o.options.screens,densities:s.densities,modifiers:{...h.value,format:f}});return{src:P,type:`image/${f}`,sizes:w,srcset:E}}))}),c=a(()=>p.value[p.value.length-1]),m={...s.imgAttrs,"data-nuxt-pic":""};for(const e in v)e in L&&!(e in m)&&(m[e]=v[e]);const r=M(),k=O().isHydrating;return $(()=>{r.value&&(r.value.complete&&k&&(r.value.getAttribute("data-error")?n("error",new Event("error")):n("load",new Event("load"))),r.value.onload=e=>{n("load",e)},r.value.onerror=e=>{n("error",e)},D("nuxt-picture"))}),(e,g)=>(u(),l("picture",null,[(u(!0),l(H,null,T(p.value.slice(0,-1),t=>(u(),l("source",{key:t.src,type:t.type,sizes:t.sizes,srcset:t.srcset},null,8,q))),128)),c.value?(u(),l("img",U({key:0,ref_key:"imgEl",ref:r},{...b(z),...b(x)?{onerror:"this.setAttribute('data-error', 1)"}:{},...m},{src:c.value.src,sizes:c.value.sizes,srcset:c.value.srcset}),null,16,G)):V("",!0)]))}});export{Q as _};
